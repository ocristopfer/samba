[supervisord]
nodaemon=true
user=root
pidfile=/var/run/supervisord.pid
logfile=/var/log/supervisord.log
logfile_maxbytes=50MB
logfile_backups=10
childlogdir=/var/log/supervisor
loglevel=info
silent=false

[supervisorctl]
serverurl=unix:///var/run/supervisor.sock

[unix_http_server]
file=/var/run/supervisor.sock
chmod=0700
username=supervisor
password=supervisor123

[inet_http_server]
port=127.0.0.1:9001
username=supervisor
password=supervisor123

[rpcinterface:supervisor]
supervisor.rpcinterface_factory = supervisor.rpcinterface:make_main_rpcinterface

# NetBIOS Name Server - handles name resolution
[program:nmbd]
command=/usr/sbin/nmbd --foreground --no-process-group --log-stdout
directory=/
autostart=true
autorestart=true
startretries=3
user=root
priority=100
stdout_logfile=/var/log/samba/nmbd.log
stdout_logfile_maxbytes=10MB
stdout_logfile_backups=5
stderr_logfile=/var/log/samba/nmbd.error.log
stderr_logfile_maxbytes=10MB
stderr_logfile_backups=5
redirect_stderr=false
killasgroup=true
stopasgroup=true

# SMB/CIFS File Server - handles file sharing
[program:smbd]
command=/usr/sbin/smbd --foreground --no-process-group --log-stdout
directory=/
autostart=true
autorestart=true
startretries=3
user=root
priority=200
stdout_logfile=/var/log/samba/smbd.log
stdout_logfile_maxbytes=10MB
stdout_logfile_backups=5
stderr_logfile=/var/log/samba/smbd.error.log
stderr_logfile_maxbytes=10MB
stderr_logfile_backups=5
redirect_stderr=false
killasgroup=true
stopasgroup=true

# Optional: Windows Internet Name Service (uncomment if needed)
# [program:winbindd]
# command=/usr/sbin/winbindd --foreground --no-process-group
# directory=/
# autostart=false
# autorestart=true
# startretries=3
# user=root
# priority=300
# stdout_logfile=/var/log/samba/winbindd.log
# stdout_logfile_maxbytes=10MB
# stdout_logfile_backups=5
# stderr_logfile=/var/log/samba/winbindd.error.log
# stderr_logfile_maxbytes=10MB
# stderr_logfile_backups=5
# redirect_stderr=false
# killasgroup=true
# stopasgroup=true

# Log monitoring program (optional)
[program:tail-smbd]
command=tail -f /var/log/samba/log.smbd
autostart=false
autorestart=true
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0
priority=999

[program:tail-nmbd]
command=tail -f /var/log/samba/log.nmbd
autostart=false
autorestart=true
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0
priority=999